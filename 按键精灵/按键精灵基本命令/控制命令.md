---
layout: dmLayout
---    

# 控制命令


##  Call 调用过程

调用过程

- **示例**:

按键精灵8 及以上语法
```js
 Call 子程序("我是子程序,被你调用了")  
EndScript  />
//支持中文名变量  />
Sub 子程序(啊)  
    Msgbox 啊  
End Sub  />
//定义一个过程,可以在脚本中调用这个过程
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 字符串型，过程名



按键精灵7 及以下语法:

```js
无 
```




##  Do 循环

条件循环

- **示例**:

按键精灵8 及以上语法
```js
 例子1：  />
//支持ExitDo 命令退出循环  
i=0  
Do While i=0  
    Msgbox "我停不下来啦!!快住手"  
Loop  />
//当循环条件成立的时候，反复执行循环体  />
  
  
例子2：  
i=0  
Do Until i=0  
    Msgbox "为什么没有循环到我呢？"  
Loop  
Msgbox "循环结束"  />
//当循环条件成立的时候，离开循环体  />
  
  
例子3：  
i=0  
Do Until i=1  
    Msgbox "我停不下来啦!!快住手"  
Loop  />
//当循环条件不成立的时候，反复执行循环体  />
  
  
例子4：  
n=0  
Do While true  
    Msgbox "我将循环10次停下来!!"  
    If n>=10 Then  
       //当循环条件成立的时候，离开循环体  />
        Exit do  
    End if  
    n=n+1  
Loop  
Msgbox n & "次"  
  
  
例子5：  
i = 0  
Do   
  MessageBox "ok"  
Loop While i <> 0  />
//条件放后面，前面的循环内容可以执行一次！
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 条件型，循环条件



按键精灵7 及以下语法:

```js
无 
```




##  EndScript 脚本停止运行

强制结束脚本的执行

- **示例**:

按键精灵8 及以上语法
```js
 EndScript//强制结束脚本的执行，在这个语句之后的所有命令都不会执行
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数无



按键精灵7 及以下语法:

```js
EndScript//强制结束脚本的执行，在这个语句之后的所有命令都不会执行
```




##  ExitScript 脚本退出运行

强制中止退出脚本的执行

- **示例**:

按键精灵8 及以上语法
```js
 BeginThread aa  
    for 3   
        Delay 1000  
    Next   
    ExitScript   
   //强制中止退出脚本的执行，在这个语句之后的所有命令都不会执行  />
    Sub aa()  
        i=0  
        Do   
            Call Plugin.Msg.ShowScrTXT(0, 0, 1024, 768, "屏幕内容填写"&i, "0000FF")   
            Delay 1000  
            i=i+1  
        Loop   
    End Sub 
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数无



按键精灵7 及以下语法:

```js
无 
```




##  For 循环

循环一定次数

- **示例**:

按键精灵8 及以上语法
```js
 例子1：  />
//支持ExitFor 命令退出循环  
For i=0 To 9  
    Delay 100  
Next  />
//循环10次  />
  
例子2：  />
//支持ExitFor 命令退出循环  
For 10  
    Delay 100  
Next  />
//循环10次  />
  
  
例子3：  />
//支持ExitFor 命令退出循环  
For i=0 to 19 step 2  
    Delay 100  
Next  />
//循环10次  />
  
例子4：  />
//支持ExitFor 命令退出循环  
For i=0 to 19 step 2  
    Delay 100  
    If i>9 Then  
        Exit For   
    End If  
Next  />
//循环5次
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，循环次数



按键精灵7 及以下语法:

```js
For 10  
   Delay 100  
EndFor  />
//循环10次
```




##  Function 函数

函数

- **示例**:

按键精灵8 及以上语法
```js
 //支持Exit,Function命令退出函数过程  />
Msgbox 函数过程("我是函数,被你调用了")  
EndScript  
Function 函数过程(a)  
     函数过程=a  
End Function  />
//定义一个函数过程,可以在脚本中调用这个函数
```

- 返回值: 

    多类型

- 函数原型:

    无

- 参数定义:

    - 参数多类型，多



按键精灵7 及以下语法:

```js
无 
```




##  Goto 跳转到标记

跳转到Rem标记处

- **示例**:

按键精灵8 及以上语法
```js
 Goto 标记  
Delay 100  
Rem 标记  
Msgbox "你直接跳到这里了!!,上面的延迟没有被执行!!"  />
//跳转语句，可以跳转到rem标记过的标记处继续执行
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 字符串型，标号



按键精灵7 及以下语法:

```js
Goto 标记  
Delay 100  
Rem 标记  
Msgbox "你直接跳到这里了!!,上面的延迟没有被执行!!"  />
//跳转语句，可以跳转到rem标记过的标记处继续执行
```




##  If 如果..则

判断表达式

- **示例**:

按键精灵8 及以上语法
```js
 例子1：  
    i=0  
    If i=0 Then  
        Msgbox "条件判断符合被通过!!"  
    End If  
   //通过判断表达式的取值，来执行后面的动作或控制  />
      
    例子2：  
    i=1  
    If i=0 Then  
        Msgbox "条件判断符合被通过!!"  
    ElseIf i=1 Then  
        Msgbox "否则条件判断符合被通过!!"  
    Else  
        Msgbox "否则!!"  
    End If  
   //通过判断表达式的取值，来执行后面的动作或控制
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 条件型，表达式



按键精灵7 及以下语法:

```js
i=0  
    If i=0  
        Msgbox "条件判断符合被通过!!"  
    EndIf  
   //通过判断表达式的取值，来执行后面的动作或控制
```




##  IfColor 颜色判断

判断屏幕某点的颜色

- **示例**:

按键精灵8 及以上语法
```js
 例子1：
//判断条件(0:等于 1:不等于 2:近似等于)
IfColor 860,27,"e1b072",0 Then
    Msgbox "颜色等于"
Else 
    Msgbox "颜色不等于"
End If
//判断坐标点(860,27)的颜色是否等于e1b072


例子2：
a=1:b=1
IfColor 650,118,"78F0E8",2 Then
    MessageBox "a"
ElseIf b=a Then
    MessageBox "b"
End if

```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，屏幕X坐标
参数2 整数型，屏幕Y坐标
参数3 字符串型，颜色16进制值
参数4 整数型，判断条件



按键精灵7 及以下语法:

```js
//判断条件(0:等于 1:不等于 2:近似等于)
IfColor 860,27,e1b072,0
    Msgbox "颜色等于"
Else 
    Msgbox "颜色不等于"
EndIf
//判断坐标点(860,27)的颜色是否等于e1b072
```




##  Rem 标记/注释

标记命令可当注释

- **示例**:

按键精灵8 及以上语法
```js
 //不支持数字开头的和符号作为标记名//标记命令.即可当注释,也可以为Goto跳转指令作标记Rem 脚本开始 
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 字符串型，文字



按键精灵7 及以下语法:

```js
//标记命令.即可当注释,也可以为Goto跳转指令作标记Rem 脚本开始 
```




##  RestartScript 重新启动脚本运行

重新启动脚本运行

- **示例**:

按键精灵8 及以上语法
```js
 For i=0 to 2   
     Delay 1000  
Call Plugin.Msg.ShowScrTXT(0,0,1024,768,"屏幕内容填写"&i,"0000FF")   
Next   
RestartScript//重新启动脚本运行
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数无



按键精灵7 及以下语法:

```js
无 
```




##  Select 情况条件选择

根据情况选择条件判断

- **示例**:

按键精灵8 及以上语法
```js
 //不支持判断语句如：Case a>0  
    UserVar 变量=0 "输入（0~9）数字"  
   //<>---------------------------------------------以下是选择条件结结构判断  />
    Select Case 变量  
    Case 0  
        Msgbox "你输入的数字为：0"   
    Case 1  
        Msgbox "你输入的数字为：1"   
    Case 2  
        Msgbox "你输入的数字为：2"   
    Case 3  
        Msgbox "你输入的数字为：3"   
    Case 4  
        Msgbox "你输入的数字为：4"   
    Case 5  
        Msgbox "你输入的数字为：5"   
    Case 6  
        Msgbox "你输入的数字为：6"   
    Case 7  
        Msgbox "你输入的数字为：7"   
    Case 8  
        Msgbox "你输入的数字为：8"   
    Case 9  
        Msgbox "你输入的数字为：9"   
    Case Else  
        Msgbox "你输入的数字不正确，请输入（0~9）数字！"  
    End Select 
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 条件型，情况



按键精灵7 及以下语法:

```js
无 
```




##  Sub 子程序

定义一个过程

- **示例**:

按键精灵8 及以上语法
```js
 //支持ExitSub 命令退出子程序过程  
Call 子程序()  
EndScript  
Sub 子程序()  
    Msgbox "我是子程序,被你调用了"  
End Sub  />
//定义一个过程,可以在脚本中调用这个过程
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 字符串型，过程名



按键精灵7 及以下语法:

```js
Gosub 子程序  
EndScript  
Sub 子程序  
    Msgbox "我是子程序,被你调用了"  
Return 子程序  />
//定义一个过程,可以在脚本中调用这个过程
```




##  While 如果..则循环

条件循环

- **示例**:

按键精灵8 及以上语法
```js
 i=0  
While i=0  
    Msgbox "我停不下来啦!!快住手"  
Wend  />
//当循环条件成立的时候，反复执行循环体
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 条件型，循环条件



按键精灵7 及以下语法:

```js
i=0  
While i=0  
    Msgbox "我停不下来啦!!快住手"  
EndWhile  />
//当循环条件成立的时候，反复执行循环体
```



