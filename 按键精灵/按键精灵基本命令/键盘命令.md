---
layout: dmLayout
---    

# 键盘命令


##  GetLastKey 检测上次按键

检测上次按键

- **示例**:

按键精灵8 及以上语法
```js
 //脚本运行到这一行不会暂停,调用的时候立即返回，得到调用之前最后一次按下的按键码保存在变量Key里。Key=GetLastKey()
If Key = 13 Then
  Msgbox "你上次按下了回车键"
EndIf 
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，可选：变量名



按键精灵7 及以下语法:

```js
//脚本运行到这一行不会暂停,调用的时候立即返回，得到调用之前最后一次按下的按键码保存在变量Key里。GetLastKey Key If Key = 13 
    Msgbox "你上次按下了回车键"
EndIf 
```




##  KeyDown 按住

键盘按住

- **示例**:

按键精灵8 及以上语法
```js
 //KeyDown、KeyDownS、KeyDownH//KeyDownS:超级模拟方式,兼容性更强,对键盘和鼠标没有特别的要求,PS2(圆口)和USB接口的键盘都可以使用//KeyDownH:硬件模拟方式,仅支持PS(圆口)的键盘/>
KeyDown 65,1//65是A键的按键码，上面的语句表示按住A键1次KeyDown "A",1//上面的支持按键字符，语句表示按住A键1次
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，键盘虚拟码（8.X支持 按键字符）参数2 整数型，次数



按键精灵7 及以下语法:

```js
//KeyDown、KeyDownS、KeyDownH//KeyDownS:超级模拟方式,兼容性更强,对键盘和鼠标没有特别的要求,PS2(圆口)和USB接口的键盘都可以使用//KeyDownH:硬件模拟方式,仅支持PS(圆口)的键盘/>
KeyDown 65,1//65是A键的按键码，上面的语句表示按住A键1次
```




##  KeyPress 按键

键盘按键

- **示例**:

按键精灵8 及以上语法
```js
 //KeyPress、KeyPressS、KeyPressH/>
//KeyPressS:超级模拟方式,兼容性更强,对键盘和鼠标没有特别的要求,PS2(圆口)和USB接口的键盘都可以使用/>
//KeyPressH:硬件模拟方式,仅支持PS(圆口)的键盘/>
KeyPress 65,1/>
//65是A键的按键码，上面的语句表示按A键1次/>
KeyPress "A",1/>
//上面的支持按键字符，语句表示按A键1次
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，键盘虚拟码（8.X支持 按键字符）参数2 整数型，次数



按键精灵7 及以下语法:

```js
//KeyPress、KeyPressS、KeyPressH/>
//KeyPressS:超级模拟方式,兼容性更强,对键盘和鼠标没有特别的要求,PS2(圆口)和USB接口的键盘都可以使用/>
//KeyPressH:硬件模拟方式,仅支持PS(圆口)的键盘/>
KeyPress 65,1/>
//65是A键的按键码，上面的语句表示按A键1次
```




##  KeyUp 弹起

键盘弹起

- **示例**:

按键精灵8 及以上语法
```js
 //KeyUp、KeyUpS、KeyUpH//KeyUpS:超级模拟方式,兼容性更强,对键盘和鼠标没有特别的要求,PS2(圆口)和USB接口的键盘都可以使用//KeyUpH:硬件模拟方式,仅支持PS(圆口)的键盘/>
KeyUp 65,1//65是A键的按键码，上面的语句表示松开A键1次KeyUp "A",1//上面的支持按键字符，语句表示松开A键1次
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，键盘虚拟码（8.X支持 按键字符）参数2 整数型，次数



按键精灵7 及以下语法:

```js
//KeyUp、KeyUpS、KeyUpH//KeyUpS:超级模拟方式,兼容性更强,对键盘和鼠标没有特别的要求,PS2(圆口)和USB接口的键盘都可以使用//KeyUpH:硬件模拟方式,仅支持PS(圆口)的键盘/>
KeyUp 65,1//65是A键的按键码，上面的语句表示松开A键1次
```




##  WaitKey 等待按任意键

等待按任意键

- **示例**:

按键精灵8 及以上语法
```js
 Key=WaitKey()//脚本运行到这一行会暂停,当用户按下键盘后继续执行,并且把用户的按键码保存在变量Key里If Key = 13 Then
   MessageBox "恭喜你按下了回车键"
End If 
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，可选：变量名



按键精灵7 及以下语法:

```js
WaitKey Key//脚本运行到这一行会暂停,当用户按下键盘后继续执行,并且把用户的按键码保存在变量Key里If Key = 13 
     Msgbox "恭喜你按下了回车键"
EndIf 
```



