---
layout: dmLayout
---    

# 颜色（增强）


##  FindColor 区域找色

区域找色（9.00版新功能）

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句在屏幕区域范围内截图保存到(内存)里，以备后面调用。Call Plugin.ColorEx.PrintScreen(0, 0, 1024, 768)//下面这句在屏幕区域范围内按方式0，查找颜色,返回左上角第一点颜色位置坐标XY = Plugin.ColorEx.FindColor(0, 0, 1024, 768, "0000FF", 1, 0)//下面这句用于分割字符串ZB = InStr(XY, "|")//下面这句将字符串转换成数值X = Clng(Left(XY, ZB - 1)): Y = Clng(Right(XY, Len(XY) - ZB))//释放屏幕截图信息时请使用以下命令Call Plugin.ColorEx.Free() 

```

- 返回值: 

    字符串型，左上角第一点位置坐标

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口左上角X坐标参数2 整数型，窗口左上角Y坐标参数3 整数型，窗口右下角X坐标参数4 整数型，窗口右下角Y坐标参数5 字符串型，16进制颜色值参数6 整数型，相似度参数7 整数型，查找方式（0：从右下往左上查找，1：从左上往右下查找）



按键精灵7 及以下语法:

```js
    - 无 
```




##  FindMultiColor 区域多点找色

范围区域内查找多点颜色（9.00版新功能）

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句在屏幕区域范围内截图保存到(内存)里，以备后面调用。Call Plugin.ColorEx.PrintScreen(0, 0, 1024, 768)//下面这句在屏幕区域范围内按方式0，查找多点颜色,返回左上角第一点颜色位置坐标XY = Plugin.ColorEx.FindMultiColor(0, 0, 1024, 768, "FFFFFF", "2|0|FFFFFF,-6|1|FFFFFF,-3|1|FFFFFF,-6|3|FFFFFF,-3|3|FFFFFF,0|3|FFFFFF,4|3|FFFFFF,-1|5|FFFFFF,3|5|FFFFFF,-3|6|FFFFFF,-6|7|FFFFFF,1|8|FFFFFF,4|8|FFFFFF,-5|10|FFFFFF,-3|10|FFFFFF,4|10|FFFFFF", 1, 0)//下面这句用于分割字符串ZB = InStr(XY, "|")//下面这句将字符串转换成数值X = Clng(Left(XY, ZB - 1)): Y = Clng(Right(XY, Len(XY) - ZB)) msgbox "屏幕多点找色功能：找屏幕""我""字位置位：" & X&","&Y//释放屏幕截图信息时请使用以下命令Call Plugin.ColorEx.Free() 

```

- 返回值: 

    字符串型，左上角第一点颜色位置坐标

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，屏幕左上角X坐标参数2 整数型，屏幕左上角Y坐标参数3 整数型，屏幕右下角X坐标参数4 整数型，屏幕右下角Y坐标参数5 字符串型，第一点16进制颜色值参数6 字符串型，符合偏移点颜色组(相对第一点位置偏移X坐标|相对第一点位置偏移Y坐标|16进制颜色) 参数7 整数型，相似度参数8 整数型，查找方式（0：从右下往左上查找，1：从左上往右下查找）



按键精灵7 及以下语法:

```js
    - 无 
```




##  FindPic 区域查找图片

区域查找图片（9.00版新功能）

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句在屏幕区域范围内截图保存到(内存)里，以备后面调用。Call Plugin.ColorEx.PrintScreen(0, 0, 1024, 768)//下面这句在屏幕区域范围内按方式0，查找图片,返回左上角第一点颜色位置坐标XY = Plugin.ColorEx.FindPic(0, 0, 1024, 768, "C:神盾.bmp", 1, 0)//下面这句用于分割字符串ZB = InStr(XY, "|")//下面这句将字符串转换成数值X = Clng(Left(XY, ZB - 1)): Y = Clng(Right(XY, Len(XY) - ZB))//释放屏幕截图信息时请使用以下命令Call Plugin.ColorEx.Free() 

```

- 返回值: 

    字符串型，左上角第一点位置坐标

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，屏幕左上角X坐标参数2 整数型，屏幕左上角Y坐标参数3 整数型，屏幕右下角X坐标参数4 整数型，屏幕右下角Y坐标参数5 字符串型，图片路径（不支持附件）参数6 整数型，相似度参数7 整数型，查找方式（暂时没有使用，预留接口，填0）



按键精灵7 及以下语法:

```js
    - 无 
```




##  FindShape 区域多点找形状

范围区域内查找形状（9.00版新功能）

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句在屏幕区域范围内截图保存到(内存)里，以备后面调用。Call Plugin.ColorEx.PrintScreen(0, 0, 1024, 768)//条件:0=不等,1=等于//下面这句在屏幕区域范围内按方式0，查找图形形状,返回左上角第一点颜色位置坐标XY = Plugin.ColorEx.FindShape(0, 0, 1024, 768, "2|0|1,4|0|1,6|0|0,-4|1|1,-1|1|1,5|1|1,-4|3|1,-1|3|1,2|3|1,6|3|1,-4|5|0,2|5|1,5|5|1,-1|6|1,6|6|0,-4|7|1,3|8|1,6|8|1,-4|10|0,-3|10|1,-1|10|1,2|10|0,6|10|1", 1, 0)//下面这句用于分割字符串ZB = InStr(XY, "|")//下面这句将字符串转换成数值X = Clng(Left(XY, ZB - 1)): Y = Clng(Right(XY, Len(XY) - ZB)) msgbox "屏幕找图形形状功能：找屏幕""我""字位置位：" & X&","&Y//释放屏幕截图信息时请使用以下命令Call Plugin.ColorEx.Free() 

```

- 返回值: 

    字符串型，左上角第一点位置坐标

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，屏幕左上角X坐标参数2 整数型，屏幕左上角Y坐标参数3 整数型，屏幕右下角X坐标参数4 整数型，屏幕右下角Y坐标参数5 字符串型，符合偏移形状组(相对第一点位置偏移X坐标|相对第一点位置偏移Y坐标|条件) 参数6 整数型，相似度参数7 整数型，查找方式（暂时没有使用，预留接口，填0）



按键精灵7 及以下语法:

```js
    - 无 
```




##  Free 释放屏幕截图信息

释放屏幕截图信息（9.00版新功能）

- **示例**:

按键精灵8 及以上语法
```js
    //释放屏幕截图信息Call Plugin.ColorEx.Free() 

```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数无



按键精灵7 及以下语法:

```js
    - 无 
```




##  PrintScreen 屏幕截图

屏幕范围区域截图（9.00版新功能）

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句在屏幕区域范围内截图保存到(内存)里，以备后面调用。Call Plugin.ColorEx.PrintScreen(0, 0, 1024, 768)//这里可以加入找图、找色等命令。//释放屏幕截图信息时请使用以下命令Call Plugin.ColorEx.Free() 

```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，屏幕左上角X坐标参数2 整数型，屏幕左上角Y坐标参数3 整数型，屏幕右下角X坐标参数4 整数型，屏幕右下角Y坐标



按键精灵7 及以下语法:

```js
    - 无 
```



