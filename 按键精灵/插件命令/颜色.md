---
layout: dmLayout
---    

# 颜色


##  ColorToHSL 颜色转HSL

把16进制颜色值转换分解到10进制(H,S,L)分量中

- **示例**:

按键精灵8 及以上语法
```js
 //色调(H)、饱和度(S)、亮度(L)//下面这句是把16进制颜色("0000FF")转换分解到10进制(H：H,S：S,L：L)分量中Call Plugin.Color.ColorToHSL("0000FF",H,S,L)
msgbox H &" " & S &" " & L 
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 字符串型，16进制颜色值参数2 整数型，返回10进制H分量参数3 整数型，返回10进制S分量参数4 整数型，返回10进制L分量



按键精灵7 及以下语法:

```js
//色调(H)、饱和度(S)、亮度(L)//下面这句是把16进制颜色("0000FF")转换分解到10进制(H：H,S：S,L：L)分量中Plugin Color.ColorToHSL("0000FF",H,S,L)
msgbox H &" " & S &" " & L 
```




##  ColorToRGB 颜色转RGB

把16进制颜色值转换分解到10进制(R,G,B)分量中

- **示例**:

按键精灵8 及以上语法
```js
 //下面这句是把16进制颜色("0000FF")转换分解到10进制(R：R,G：G,B：B)分量中Call Plugin.Color.ColorToRGB("ffffFF",R,G,B)
msgbox R&" " & G &" " & B 
```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 字符串型，16进制颜色值参数2 整数型，返回10进制R分量参数3 整数型，返回10进制G分量参数4 整数型，返回10进制B分量



按键精灵7 及以下语法:

```js
//下面这句是把16进制颜色("0000FF")转换分解到10进制(R：R,G：G,B：B)分量中Plugin Color.ColorToRGB("ffffFF", R,G,B)
msgbox R&" " & G &" " & B 
```




##  CountColor 区域搜索颜色数量

范围区域搜索指定色数量

- **示例**:

按键精灵8 及以上语法
```js
 //下面这句在屏幕区域范围内查找16进制颜色("0000FF")的数量NUM = Plugin.Color.CountColor(0, 0, 1024, 768, "FFFFFF",1)
msgbox "颜色(""FFFFFF"")的数量=" & NUM 
```

- 返回值: 

    整数型，颜色数量

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，屏幕左上角X坐标参数2 整数型，屏幕左上角Y坐标参数3 整数型，屏幕右下角X坐标参数4 整数型，屏幕右下角Y坐标参数5 字符串型，16进制颜色值参数6 整数型，相似度



按键精灵7 及以下语法:

```js
//下面这句在屏幕区域范围内查找16进制颜色("0000FF")的数量Plugin NUM = Color.CountColor(0, 0, 1024, 768, "FFFFFF",1)
msgbox "颜色(""FFFFFF"")的数量=" & NUM 
```




##  FindMutiColor 区域多点找色

范围区域内查找多点颜色

- **示例**:

按键精灵8 及以上语法
```js
 //下面这句在屏幕区域范围内查找多点颜色,返回左上角第一点颜色位置坐标XY=Plugin.Color.FindMutiColor(0,0,1024,768,"FFFFFF","2|0|FFFFFF,-6|1|FFFFFF,-3|1|FFFFFF,-6|3|FFFFFF,-3|3|FFFFFF,0|3|FFFFFF,4|3|FFFFFF,-1|5|FFFFFF,3|5|FFFFFF,-3|6|FFFFFF,-6|7|FFFFFF,1|8|FFFFFF,4|8|FFFFFF,-5|10|FFFFFF,-3|10|FFFFFF,4|10|FFFFFF",1)//下面这句用于分割字符串ZB = InStr(XY, "|")//下面这句将字符串转换成数值X = Clng(Left(XY, ZB - 1)): Y = Clng(Right(XY, Len(XY) - ZB))
msgbox "屏幕多点找色功能：找屏幕""我""字位置位：" & X&","&Y 
```

- 返回值: 

    字符串型，左上角第一点颜色位置坐标

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，屏幕左上角X坐标参数2 整数型，屏幕左上角Y坐标参数3 整数型，屏幕右下角X坐标参数4 整数型，屏幕右下角Y坐标参数5 字符串型，第一点16进制颜色值参数6 字符串型，符合偏移点颜色组(相对第一点位置偏移X坐标|相对第一点位置偏移Y坐标|16进制颜色) 参数7 整数型，相似度



按键精灵7 及以下语法:

```js
//下面这句在屏幕区域范围内查找多点颜色,返回左上角第一点颜色位置坐标Plugin XY=Color.FindMutiColor(0,0,1024,768,"FFFFFF","2|0|FFFFFF,-6|1|FFFFFF,-3|1|FFFFFF,-6|3|FFFFFF,-3|3|FFFFFF,0|3|FFFFFF,4|3|FFFFFF,-1|5|FFFFFF,3|5|FFFFFF,-3|6|FFFFFF,-6|7|FFFFFF,1|8|FFFFFF,4|8|FFFFFF,-5|10|FFFFFF,-3|10|FFFFFF,4|10|FFFFFF",1)//下面这句用于分割字符串ZB = InStr(XY, "|")//下面这句将字符串转换成数值X = Clng(Left(XY, ZB - 1)): Y = Clng(Right(XY, Len(XY) - ZB))
msgbox "屏幕多点找色功能：找屏幕""我""字位置位：" & X&","&Y 
```




##  FindMutiColorEx 区域多点找色（增强）

范围区域内查找多点颜色（增强）（8.20版新功能）

- **示例**:

按键精灵8 及以上语法
```js
 //下面这句在屏幕区域范围内按方式0，查找多点颜色,返回左上角第一点颜色位置坐标XY = Plugin.Color.FindMutiColorEx(0, 0, 1024, 768, "FFFFFF", "2|0|FFFFFF,-6|1|FFFFFF,-3|1|FFFFFF,-6|3|FFFFFF,-3|3|FFFFFF,0|3|FFFFFF,4|3|FFFFFF,-1|5|FFFFFF,3|5|FFFFFF,-3|6|FFFFFF,-6|7|FFFFFF,1|8|FFFFFF,4|8|FFFFFF,-5|10|FFFFFF,-3|10|FFFFFF,4|10|FFFFFF", 1, 0)//下面这句用于分割字符串ZB = InStr(XY, "|")//下面这句将字符串转换成数值X = Clng(Left(XY, ZB - 1)): Y = Clng(Right(XY, Len(XY) - ZB)) msgbox "屏幕多点找色功能：找屏幕""我""字位置位：" & X&","&Y 
```

- 返回值: 

    字符串型，左上角第一点颜色位置坐标

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，屏幕左上角X坐标参数2 整数型，屏幕左上角Y坐标参数3 整数型，屏幕右下角X坐标参数4 整数型，屏幕右下角Y坐标参数5 字符串型，第一点16进制颜色值参数6 字符串型，符合偏移点颜色组(相对第一点位置偏移X坐标|相对第一点位置偏移Y坐标|16进制颜色) 参数7 整数型，相似度参数8 整数型，查找方式（0：从右下往左上查找，1：从左上往右下查找）



按键精灵7 及以下语法:

```js
无 
```




##  FindShape 区域多点找形状

范围区域内查找形状

- **示例**:

按键精灵8 及以上语法
```js
 //条件:0=不等,1=等于//下面这句在屏幕区域范围内查找图形形状,返回左上角第一点坐标位置XY = Plugin.Color.FindShape(0, 0, 1024, 768, "2|0|1,4|0|1,6|0|0,-4|1|1,-1|1|1,5|1|1,-4|3|1,-1|3|1,2|3|1,6|3|1,-4|5|0,2|5|1,5|5|1,-1|6|1,6|6|0,-4|7|1,3|8|1,6|8|1,-4|10|0,-3|10|1,-1|10|1,2|10|0,6|10|1", 1)//下面这句用于分割字符串ZB = InStr(XY, "|")//下面这句将字符串转换成数值X = Clng(Left(XY, ZB - 1)): Y = Clng(Right(XY, Len(XY) - ZB)) msgbox "屏幕找图形形状功能：找屏幕""我""字位置位：" & X&","&Y 
```

- 返回值: 

    字符串型，左上角第一点位置坐标

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，屏幕左上角X坐标参数2 整数型，屏幕左上角Y坐标参数3 整数型，屏幕右下角X坐标参数4 整数型，屏幕右下角Y坐标参数5 字符串型，符合偏移形状组(相对第一点位置偏移X坐标|相对第一点位置偏移Y坐标|条件) 参数6 整数型，相似度



按键精灵7 及以下语法:

```js
//条件:0=不等,1=等于//下面这句在屏幕区域范围内查找图形形状,返回左上角第一点坐标位置Plugin XY = Color.FindShape(0, 0, 1024, 768, "2|0|1,4|0|1,6|0|0,-4|1|1,-1|1|1,5|1|1,-4|3|1,-1|3|1,2|3|1,6|3|1,-4|5|0,2|5|1,5|5|1,-1|6|1,6|6|0,-4|7|1,3|8|1,6|8|1,-4|10|0,-3|10|1,-1|10|1,2|10|0,6|10|1", 1)//下面这句用于分割字符串ZB = InStr(XY, "|")//下面这句将字符串转换成数值X = Clng(Left(XY, ZB - 1)): Y = Clng(Right(XY, Len(XY) - ZB)) msgbox "屏幕找图形形状功能：找屏幕""我""字位置位：" & X&","&Y 
```




##  GetPixelColor 得到指定点颜色

得到指定位置的点颜色（可获取透明窗口颜色）

- **示例**:

按键精灵8 及以上语法
```js
 //取色模式（0标准窗口/1透明窗口）GetCursorPos x,y cr1=Plugin.Color.GetPixelColor(x,y,1)MessageBox cr1//得到当前点的颜色，并弹出对话框显示出来
```

- 返回值: 

    字符串型，得到的颜色16进制值

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，屏幕X坐标参数2 整数型，屏幕Y坐标参数3 整数型，取色模式（0标准窗口/1透明窗口）



按键精灵7 及以下语法:

```js
无 
```




##  GetRGB 得到RGB分量合并值

把10进制(R,G,B)分量合并到16进制颜色值中

- **示例**:

按键精灵8 及以上语法
```js
 //下面这句是把10进制(R：255,G：0,B：0)分量合并到16进制颜色值变量(Color)中Color = Plugin.Color.GetRGB(255, 0, 0)
msgbox "得到16进制颜色值:" & color 
```

- 返回值: 

    字符串型，16进制颜色值

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，10进制R分量参数2 整数型，10进制G分量参数3 整数型，10进制B分量



按键精灵7 及以下语法:

```js
//下面这句是把10进制(R：255,G：0,B：0)分量合并到16进制颜色值变量(Color)中Plugin Color = Color.GetRGB(255, 0, 0)
msgbox "得到16进制颜色值:" & color 
```



