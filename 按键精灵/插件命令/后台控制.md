---
layout: dmLayout
---    

# 后台控制


##  FindCenterColor 中心找色

范围中心找色(不支持win2000以下系统)

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句按从中间到四周的顺序查找窗口句柄(变量：Hwnd)窗口的指定的矩形区域内指定颜色XY = Plugin.BkgndColor.FindCenterColor(Hwnd, 0, 0, 20, 20, "FFFFFF")//下面这句用于分割字符串,将横坐标和纵坐标分成两个字符串dim MyArray MyArray = Split(XY, "|")//下面这句将字符串转换成数值X = Clng(MyArray(0)): Y = Clng(MyArray(1)) Msgbox "后台窗口颜色X坐标="& X & " Y坐标=" & Y 

```

- 返回值: 

    字符串型，颜色位置坐标

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口句柄参数2 整数型，窗口左上角X坐标参数3 整数型，窗口左上角Y坐标参数4 整数型，窗口右下角X坐标参数5 整数型，窗口右下角Y坐标参数6 字符串型，16进制颜色值



按键精灵7 及以下语法:

```js
    - //下面这句按从中间到四周的顺序查找窗口句柄(变量：Hwnd)窗口的指定的矩形区域内指定颜色Plugin XY = BkgndColor.FindCenterColor(Hwnd, 0, 0, 20, 20, "FFFFFF")//下面这句用于分割字符串,将横坐标和纵坐标分成两个字符串MyArray = Split(XY, "|")//下面这句将字符串转换成数值X = Clng(MyArray(0)): Y = Clng(MyArray(1)) Msgbox "后台窗口颜色X坐标="& X & " Y坐标=" & Y 
```




##  FindColor 区域找色

区域找色(不支持win2000以下系统)

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句按从左到右，从上到下的顺序查找窗口句柄(变量：Hwnd)窗口的指定矩形区域内指定颜色XY = Plugin.BkgndColor.FindColor(Hwnd, 0, 0, 20, 20, "FFFFFF")//下面这句用于分割字符串,将横坐标和纵坐标分成两个字符串dim MyArray MyArray = Split(XY, "|")//下面这句将字符串转换成数值X = Clng(MyArray(0)): Y = Clng(MyArray(1))
Msgbox "后台窗口颜色X坐标="& X & " Y坐标=" & Y 

```

- 返回值: 

    字符串型，颜色位置坐标

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口句柄参数2 整数型，窗口左上角X坐标参数3 整数型，窗口左上角Y坐标参数4 整数型，窗口右下角X坐标参数5 整数型，窗口右下角Y坐标参数6 字符串型，16进制颜色值



按键精灵7 及以下语法:

```js
    - //下面这句按从左到右，从上到下的顺序查找窗口句柄(变量：Hwnd)窗口的指定矩形区域内指定颜色Plugin XY = BkgndColor.FindColor(Hwnd, 0, 0, 20, 20, "FFFFFF")//下面这句用于分割字符串,将横坐标和纵坐标分成两个字符串MyArray = Split(XY, "|")//下面这句将字符串转换成数值X = Clng(MyArray(0)): Y = Clng(MyArray(1))
Msgbox "后台窗口颜色X坐标="& X & " Y坐标=" & Y 
```




##  FindColorEx 模糊找色

范围模糊找色(不支持win2000以下系统)

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句按(从左到右从上到下的顺序找色)模糊查找窗口句柄(变量：Hwnd)窗口的指定矩形区域内指定颜色XY = Plugin.BkgndColor.FindColorEx(Hwnd, 0, 0, 20, 20, "FFFFFF", 0, 0.9)//下面这句用于分割字符串dim MyArray MyArray = Split(XY, "|")//下面这句将字符串转换成数值X = Clng(MyArray(0)): Y = Clng(MyArray(1)) Msgbox "后台窗口颜色X坐标="& X & " Y坐标=" & Y 

```

- 返回值: 

    字符串型，颜色位置坐标

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口句柄参数2 整数型，窗口左上角X坐标参数3 整数型，窗口左上角Y坐标参数4 整数型，窗口右下角X坐标参数5 整数型，窗口右下角Y坐标参数6 字符串型，16进制颜色值参数7 整数型，查找方向(0从左到右从上到下的顺序找色,1从中间到四周的顺序找色) 参数8 整数型，相似度（小数0.1～1.0）,1.0最相似



按键精灵7 及以下语法:

```js
    - //下面这句按(从左到右从上到下的顺序找色)模糊查找窗口句柄(变量：Hwnd)窗口的指定矩形区域内指定颜色Plugin XY = BkgndColor.FindColorEx(Hwnd, 0, 0, 20, 20, "FFFFFF", 0, 0.9)//下面这句用于分割字符串MyArray = Split(XY, "|")//下面这句将字符串转换成数值X = Clng(MyArray(0)): Y = Clng(MyArray(1)) Msgbox "后台窗口颜色X坐标="& X & " Y坐标=" & Y 
```




##  GetPixelColor 得到指定点颜色

得到指定点颜色(不支持win2000以下系统)

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句取窗口句柄(变量：Hwnd)窗口的客户区(坐标：5,5)处的颜色Color = Plugin.Bkgnd.GetPixelColor(Hwnd, 5, 5)
Msgbox "后台窗口(坐标：5,5)处的颜色=" & Color 

```

- 返回值: 

    字符串型，16进制颜色值

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口句柄参数2 整数型，窗口X坐标参数3 整数型，窗口Y坐标



按键精灵7 及以下语法:

```js
    - //下面这句取窗口句柄(变量：Hwnd)窗口的客户区(坐标：5,5)处的颜色Plugin Color = Bkgnd.GetPixelColor(Hwnd, 5, 5)
Msgbox "后台窗口(坐标：5,5)处的颜色=" & Color 
```




##  KeyDown 按下

向后台窗口句柄发送一个键盘按下

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句用于向后台窗口句柄(变量：Hwnd)发送一个键盘(扫描码：66)按下Call Plugin.Bkgnd.KeyDown(Hwnd, 66)
Msgbox "在后台窗口输入B键" 

```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口句柄参数2 整数型，键盘扫描码



按键精灵7 及以下语法:

```js
    - //下面这句用于向后台窗口句柄(变量：Hwnd)发送一个键盘(扫描码：66)按下Plugin Bkgnd.KeyDown(Hwnd, 66)
Msgbox "在后台窗口输入B键" 
```




##  KeyPress 按键

向后台窗口句柄发送一个键盘按键

- **示例**:

按键精灵8 及以上语法
```js
    Call RunApp("notepad.exe") Delay 1000//=================================================================================//找记事本输入区句柄Hwnd=Plugin.Window.Find("notepad",0)
Hwnd=Plugin.Window.FindEx(Hwnd, 0, "Edit", 0)//注意:会发送2次按键//下面这句用于向后台窗口句柄(变量：Hwnd)发送一个键盘(扫描码：65)按键Call Plugin.Bkgnd.KeyPress(Hwnd, 65)
Msgbox "在后台窗口输入A键" 

```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口句柄参数2 整数型，键盘扫描码



按键精灵7 及以下语法:

```js
    - VBSCall RunApp("notepad.exe") Delay 1000//=================================================================================//找记事本输入区句柄Plugin Hwnd=Window.Find("notepad",0)
Plugin Hwnd=Window.FindEx(Hwnd, 0, "Edit", 0)//注意:会发送2次按键//下面这句用于向后台窗口句柄(变量：Hwnd)发送一个键盘(扫描码：65)按键Plugin Bkgnd.KeyPress(Hwnd, 65)
Msgbox "在后台窗口输入A键" 
```




##  KeyUp 弹起

向后台窗口句柄发送一个键盘弹起

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句用于向后台窗口句柄(变量：Hwnd)发送一个键盘(扫描码：65)弹起Call Plugin.Bkgnd.KeyUp(Hwnd, 65)
Msgbox "在后台窗口弹起B键" 

```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口句柄参数2 整数型，键盘扫描码



按键精灵7 及以下语法:

```js
    - //下面这句用于向后台窗口句柄(变量：Hwnd)发送一个键盘(扫描码：65)弹起Plugin Bkgnd.KeyUp(Hwnd, 65)
Msgbox "在后台窗口弹起B键" 
```




##  LeftClick 左键单击

向后台窗口句柄送一个鼠标左键单击

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句用于向后台窗口句柄(变量：Hwnd)的客户区域(坐标：5,5)处发送一个鼠标左键单击Call Plugin.Bkgnd.LeftClick(Hwnd, 5, 5)
Msgbox "鼠标在后台窗口(坐标：5,5)处的单击" 

```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口句柄参数2 整数型，窗口X坐标参数3 整数型，窗口Y坐标



按键精灵7 及以下语法:

```js
    - //下面这句用于向后台窗口句柄(变量：Hwnd)的客户区域(坐标：5,5)处发送一个鼠标左键单击Plugin Bkgnd.LeftClick(Hwnd, 5, 5)
Msgbox "鼠标在后台窗口(坐标：5,5)处的单击" 
```




##  LeftDoubleClick 左键双击

向后台窗口句柄发送一个鼠标左键双击

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句用于向后台窗口句柄(变量：Hwnd)的客户区域(坐标：10,10)处发送一个鼠标左键双击Call Plugin.Bkgnd.LeftDoubleClick(Hwnd, 10, 10)
Msgbox "鼠标在后台窗口(坐标：10,10)处的双击" 

```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口句柄参数2 整数型，窗口X坐标参数3 整数型，窗口Y坐标



按键精灵7 及以下语法:

```js
    - //下面这句用于向后台窗口句柄(变量：Hwnd)的客户区域(坐标：10,10)处发送一个鼠标左键双击Plugin Bkgnd.LeftDoubleClick(Hwnd, 10, 10)
Msgbox "鼠标在后台窗口(坐标：10,10)处的双击" 
```




##  LeftDown 左键按下

向后台窗口句柄发送一个鼠标左键按下

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句用于向后台窗口句柄(变量：Hwnd)的客户区域(坐标：10,10)处发送一个鼠标左键按下Call Plugin.Bkgnd.LeftDown(Hwnd, 10,10) 

```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口句柄参数2 整数型，窗口X坐标参数3 整数型，窗口Y坐标



按键精灵7 及以下语法:

```js
    - //下面这句用于向后台窗口句柄(变量：Hwnd)的客户区域(坐标：10,10)处发送一个鼠标左键按下Plugin Bkgnd.LeftDown(Hwnd, 10,10) 
```




##  LeftUp 左键弹起

向后台窗口句柄发送一个鼠标左键弹起

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句用于向后台窗口句柄(变量：Hwnd)的客户区域(坐标：10,10)处发送一个鼠标左键弹起Call Plugin.Bkgnd.LeftUp(Hwnd, 10,10) 

```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口句柄参数2 整数型，窗口X坐标参数3 整数型，窗口Y坐标



按键精灵7 及以下语法:

```js
    - //下面这句用于向后台窗口句柄(变量：Hwnd)的客户区域(坐标：10,10)处发送一个鼠标左键弹起Plugin Bkgnd.LeftUp(Hwnd, 10,10) 
```




##  MiddleClick 中键单击

向后台窗口句柄发送一个鼠标中键单击

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句用于向后台窗口句柄(变量：Hwnd)的客户区域(坐标：10,10)处发送一个鼠标中键单击Call Plugin.Bkgnd.MiddleClick(Hwnd, 10,10) 

```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口句柄参数2 整数型，窗口X坐标参数3 整数型，窗口Y坐标



按键精灵7 及以下语法:

```js
    - //下面这句用于向后台窗口句柄(变量：Hwnd)的客户区域(坐标：10,10)处发送一个鼠标中键单击Plugin Bkgnd.MiddleClick(Hwnd,10,10) 
```




##  MoveTo 鼠标移动

向后台窗口句柄发送一个鼠标移动到坐标处

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句用于向后台窗口句柄(变量：Hwnd)发送一个鼠标移动到客户区域(坐标：10,10)处Call Plugin.Bkgnd.MoveTo(Hwnd, 10,10) 

```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口句柄参数2 整数型，窗口X坐标参数3 整数型，窗口Y坐标



按键精灵7 及以下语法:

```js
    - //下面这句用于向后台窗口句柄(变量：Hwnd)发送一个鼠标移动到客户区域(坐标：10,10)处Plugin Bkgnd.MoveTo(Hwnd, 10,10) 
```




##  RightClick 右键单击

向后台窗口句柄发送一个鼠标右键单击

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句用于向后台窗口句柄(变量：Hwnd)的客户区域(坐标：0,0)处发送一个鼠标右键单击Call Plugin.Bkgnd.RightClick(Hwnd, 0,0)
Msgbox "鼠标在后台窗口(坐标：0,0)处的右击" 

```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口句柄参数2 整数型，窗口X坐标参数3 整数型，窗口Y坐标



按键精灵7 及以下语法:

```js
    - //下面这句用于向后台窗口句柄(变量：Hwnd)的客户区域(坐标：0,0)处发送一个鼠标右键单击Plugin Bkgnd.RightClick(Hwnd, 0,0)
Msgbox "鼠标在后台窗口(坐标：0,0)处的右击" 
```




##  RightDown 右键按下

向后台窗口句柄发送一个鼠标右键按下

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句用于向后台窗口句柄(变量：Hwnd)的客户区域(坐标：10,10)处发送一个鼠标右键按下Call Plugin.Bkgnd.RightDown(Hwnd, 10,10) 

```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口句柄参数2 整数型，窗口X坐标参数3 整数型，窗口Y坐标



按键精灵7 及以下语法:

```js
    - //下面这句用于向后台窗口句柄(变量：Hwnd)的客户区域(坐标：10,10)处发送一个鼠标右键按下Plugin Bkgnd.RightDown(Hwnd, 10,10) 
```




##  RightUp 右键弹起

向后台窗口句柄发送一个鼠标右键弹起

- **示例**:

按键精灵8 及以上语法
```js
    //下面这句用于向后台窗口句柄(变量：Hwnd)的客户区域(坐标：10,10)处发送一个鼠标右键弹起Call Plugin.Bkgnd.RightUp(Hwnd, 10,10) 

```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口句柄参数2 整数型，窗口X坐标参数3 整数型，窗口Y坐标



按键精灵7 及以下语法:

```js
    - //下面这句用于向后台窗口句柄(变量：Hwnd)的客户区域(坐标：10,10)处发送一个鼠标右键弹起Plugin Bkgnd.RightUp(Hwnd, 10,10) 
```




##  SendString 发送字符串

向后台窗口句柄发送一个文本消息

- **示例**:

按键精灵8 及以上语法
```js
    Call RunApp("notepad.exe") Delay 1500//0表示忽略//下面这句是查找窗口类名("Notepad")或者标题(0),返回找到的句柄HwndHwnd = Plugin.Window.Find("Notepad", 0)
Hwnd=Plugin.Window.FindEx(Hwnd, 0, "Edit", 0)//下面这句用于向后台窗口句柄(变量：Hwnd)发送一个文本消息(内容："内容")到客户区Call Plugin.Window.SendString(Hwnd, "内容")
TracePrint "发送一个文本消息(内容)" 

```

- 返回值: 

    无

- 函数原型:

    无

- 参数定义:

    - 参数1 整数型，窗口句柄参数2 字符串型，文本内容



按键精灵7 及以下语法:

```js
    - VBSCall RunApp("notepad.exe") Delay 1500//0表示忽略//下面这句是查找窗口类名("Notepad")或者标题(0),返回找到的句柄HwndPlugin Hwnd = Window.Find("Notepad", 0)
Plugin Hwnd = Window.FindEx(Hwnd, 0, "Edit", 0)//下面这句用于向后台窗口句柄(变量：Hwnd)发送一个文本消息(内容："内容")到客户区Plugin Window.SendString(Hwnd, "内容")
TracePrint "发送一个文本消息(内容)" 
```



